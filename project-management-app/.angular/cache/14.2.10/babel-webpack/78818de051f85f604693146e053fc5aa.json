{"ast":null,"code":"import * as TeamsActions from 'src/app/store/actions/teams.actions';\nimport * as TeamsSelectors from 'src/app/store/selectors/teams.selectors';\nimport * as AuthSelectors from 'src/app/store/selectors/auth.selectors';\nimport * as DesignersActions from 'src/app/store/actions/designers.actions'; // Para carregar designers e mostrar nomes\n\nimport * as DesignersSelectors from 'src/app/store/selectors/designers.selectors'; // Para obter designers\n\nimport { ConfirmPopupComponent } from 'src/app/shared/components/confirm-popup/confirm-popup.component';\nimport { filter, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/table\";\nimport * as i6 from \"@angular/material/icon\";\n\nfunction TeamsListPageComponent_mat_progress_bar_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 6);\n  }\n}\n\nfunction TeamsListPageComponent_div_10_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"p\");\n    i0.ɵɵtext(2, \"Nenhuma equipe encontrada para sua empresa.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_th_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 17);\n    i0.ɵɵtext(1, \" Nome \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r16 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r16.name, \" \");\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_th_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 17);\n    i0.ɵɵtext(1, \" Descri\\u00E7\\u00E3o \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_td_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r17 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", element_r17.description, \" \");\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 17);\n    i0.ɵɵtext(1, \" Projetistas \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const element_r18 = ctx.$implicit;\n    const ctx_r11 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r11.getDesignerNames(element_r18.designerIds), \" \");\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 17);\n    i0.ɵɵtext(1, \" A\\u00E7\\u00F5es \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"td\", 18)(1, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function TeamsListPageComponent_div_10_table_3_td_12_Template_button_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const element_r19 = restoredCtx.$implicit;\n      const ctx_r20 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r20.onEditTeam(element_r19.id));\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"edit\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function TeamsListPageComponent_div_10_table_3_td_12_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r21);\n      const element_r19 = restoredCtx.$implicit;\n      const ctx_r22 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r22.onDeleteTeam(element_r19.id));\n    });\n    i0.ɵɵelementStart(5, \"mat-icon\");\n    i0.ɵɵtext(6, \"delete\");\n    i0.ɵɵelementEnd()()();\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 21);\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 22);\n  }\n}\n\nfunction TeamsListPageComponent_div_10_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 8);\n    i0.ɵɵelementContainerStart(1, 9);\n    i0.ɵɵtemplate(2, TeamsListPageComponent_div_10_table_3_th_2_Template, 2, 0, \"th\", 10);\n    i0.ɵɵtemplate(3, TeamsListPageComponent_div_10_table_3_td_3_Template, 2, 1, \"td\", 11);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(4, 12);\n    i0.ɵɵtemplate(5, TeamsListPageComponent_div_10_table_3_th_5_Template, 2, 0, \"th\", 10);\n    i0.ɵɵtemplate(6, TeamsListPageComponent_div_10_table_3_td_6_Template, 2, 1, \"td\", 11);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(7, 13);\n    i0.ɵɵtemplate(8, TeamsListPageComponent_div_10_table_3_th_8_Template, 2, 0, \"th\", 10);\n    i0.ɵɵtemplate(9, TeamsListPageComponent_div_10_table_3_td_9_Template, 2, 1, \"td\", 11);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(10, 14);\n    i0.ɵɵtemplate(11, TeamsListPageComponent_div_10_table_3_th_11_Template, 2, 0, \"th\", 10);\n    i0.ɵɵtemplate(12, TeamsListPageComponent_div_10_table_3_td_12_Template, 7, 0, \"td\", 11);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(13, TeamsListPageComponent_div_10_table_3_tr_13_Template, 1, 0, \"tr\", 15);\n    i0.ɵɵtemplate(14, TeamsListPageComponent_div_10_table_3_tr_14_Template, 1, 0, \"tr\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const teams_r3 = i0.ɵɵnextContext().ngIf;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"dataSource\", teams_r3);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r5.displayedColumns);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r5.displayedColumns);\n  }\n}\n\nfunction TeamsListPageComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, TeamsListPageComponent_div_10_div_1_Template, 3, 0, \"div\", 4);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵtemplate(3, TeamsListPageComponent_div_10_table_3_Template, 15, 3, \"table\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const teams_r3 = ctx.ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", teams_r3.length === 0 && !i0.ɵɵpipeBind1(2, 2, ctx_r1.isLoading$));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", teams_r3.length > 0);\n  }\n}\n\nfunction TeamsListPageComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const error_r25 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Erro: \", error_r25 == null ? null : error_r25.message, \" \");\n  }\n}\n\nexport class TeamsListPageComponent {\n  constructor(store, dialog, router) {\n    this.store = store;\n    this.dialog = dialog;\n    this.router = router;\n    this.displayedColumns = ['name', 'description', 'designers', 'actions'];\n    this.userCompanyId = null;\n    this.allDesigners = []; // Para mapear IDs de projetistas para nomes\n\n    this.teams$ = this.store.select(TeamsSelectors.selectAllTeams);\n    this.isLoading$ = this.store.select(TeamsSelectors.selectTeamsLoading);\n    this.error$ = this.store.select(TeamsSelectors.selectTeamsError);\n    this.store.select(DesignersSelectors.selectAllDesigners).subscribe(designers => {\n      this.allDesigners = designers;\n    });\n  }\n\n  ngOnInit() {\n    this.store.select(AuthSelectors.selectUserCompanyId).pipe(filter(companyId => !!companyId), tap(companyId => {\n      this.userCompanyId = companyId;\n      this.store.dispatch(TeamsActions.loadTeams({\n        companyId: this.userCompanyId\n      }));\n      this.store.dispatch(DesignersActions.loadDesigners({\n        companyId: this.userCompanyId\n      })); // Carrega designers para a lista\n    })).subscribe();\n  }\n\n  getDesignerNames(designerIds) {\n    if (!designerIds || designerIds.length === 0) {\n      return 'Nenhum projetista';\n    }\n\n    return designerIds.map(id => this.allDesigners.find(d => d.id === id)?.name).filter(name => !!name).join(', ');\n  }\n\n  onEditTeam(teamId) {\n    this.router.navigate(['/company/teams/edit', teamId]);\n  }\n\n  onDeleteTeam(teamId) {\n    const dialogRef = this.dialog.open(ConfirmPopupComponent, {\n      data: {\n        title: 'Confirmar Exclusão',\n        message: 'Tem certeza que deseja excluir esta equipe? Esta ação é irreversível.'\n      }\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      if (result) {\n        this.store.dispatch(TeamsActions.deleteTeam({\n          id: teamId\n        }));\n      }\n    });\n  }\n\n  onCreateTeam() {\n    this.router.navigate(['/company/teams/new']);\n  }\n\n}\n\nTeamsListPageComponent.ɵfac = function TeamsListPageComponent_Factory(t) {\n  return new (t || TeamsListPageComponent)(i0.ɵɵdirectiveInject(i1.Store), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i3.Router));\n};\n\nTeamsListPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TeamsListPageComponent,\n  selectors: [[\"app-teams-list-page\"]],\n  decls: 14,\n  vars: 9,\n  consts: [[1, \"container\"], [1, \"actions\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"mode\", \"indeterminate\"], [\"mat-table\", \"\", \"class\", \"mat-elevation-z8\", 3, \"dataSource\", 4, \"ngIf\"], [\"mat-table\", \"\", 1, \"mat-elevation-z8\", 3, \"dataSource\"], [\"matColumnDef\", \"name\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"description\"], [\"matColumnDef\", \"designers\"], [\"matColumnDef\", \"actions\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", 3, \"click\"], [\"mat-icon-button\", \"\", \"color\", \"warn\", 3, \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"], [1, \"error-message\"]],\n  template: function TeamsListPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n      i0.ɵɵtext(2, \"Gerenciar Equipes\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 1)(4, \"button\", 2);\n      i0.ɵɵlistener(\"click\", function TeamsListPageComponent_Template_button_click_4_listener() {\n        return ctx.onCreateTeam();\n      });\n      i0.ɵɵelementStart(5, \"mat-icon\");\n      i0.ɵɵtext(6, \"add\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(7, \" Adicionar Equipe \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(8, TeamsListPageComponent_mat_progress_bar_8_Template, 1, 0, \"mat-progress-bar\", 3);\n      i0.ɵɵpipe(9, \"async\");\n      i0.ɵɵtemplate(10, TeamsListPageComponent_div_10_Template, 4, 4, \"div\", 4);\n      i0.ɵɵpipe(11, \"async\");\n      i0.ɵɵtemplate(12, TeamsListPageComponent_div_12_Template, 2, 1, \"div\", 5);\n      i0.ɵɵpipe(13, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(9, 3, ctx.isLoading$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(11, 5, ctx.teams$));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(13, 7, ctx.error$));\n    }\n  },\n  dependencies: [i4.NgIf, i5.MatTable, i5.MatHeaderCellDef, i5.MatHeaderRowDef, i5.MatColumnDef, i5.MatCellDef, i5.MatRowDef, i5.MatHeaderCell, i5.MatCell, i5.MatHeaderRow, i5.MatRow, i6.MatIcon, i4.AsyncPipe],\n  styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%];\\n (()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  { // webpackBootstrap\\n \\tvar __webpack_modules__ = ({\\n\\n 842:\\n\\n (() => {\\n\\nthrow new Error(\\\"Module build failed (from ./node_modules/sass-loader/dist/cjs.js):\\\\nSassError: Can't find stylesheet to import.\\\\n  \\u2577\\\\n1 \\u2502 @import '../../admin/pages/companies-list-page/companies-list-page.component.scss'; \\\\n  \\u2502         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\\\n  \\u2575\\\\n  src\\\\\\\\app\\\\\\\\company\\\\\\\\pages\\\\\\\\teams-list-page\\\\\\\\teams-list-page.component.scss 1:9  root stylesheet\\\");\\n\\n })\\n\\n \\t});\\n\\n \\t\\n \\t// startup\\n \\t// Load entry module and return exports\\n \\t// This entry module doesn't tell about it's top-level declarations so it can't be inlined\\n \\tvar __webpack_exports__ = {};\\n \\t__webpack_modules__[842]();\\n \\tresource = __webpack_exports__;\\n \\t\\n })()\\n;\"]\n});","map":{"version":3,"mappings":"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","names":["TeamsActions","TeamsSelectors","AuthSelectors","DesignersActions","DesignersSelectors","ConfirmPopupComponent","filter","tap","i0","TeamsListPageComponent","constructor","store","dialog","router","teams$","select","selectAllTeams","isLoading$","selectTeamsLoading","error$","selectTeamsError","selectAllDesigners","subscribe","designers","allDesigners","ngOnInit","selectUserCompanyId","pipe","companyId","userCompanyId","dispatch","loadTeams","loadDesigners","getDesignerNames","designerIds","length","map","id","find","d","name","join","onEditTeam","teamId","navigate","onDeleteTeam","dialogRef","open","data","title","message","afterClosed","result","deleteTeam","onCreateTeam","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["E:\\project-management-app-main\\project-management-app-main\\project-management-app\\src\\app\\company\\pages\\teams-list-page\\teams-list-page.component.ts","E:\\project-management-app-main\\project-management-app-main\\project-management-app\\src\\app\\company\\pages\\teams-list-page\\teams-list-page.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Store } from '@ngrx/store';\r\nimport { Observable } from 'rxjs';\r\nimport { Team } from 'src/app/core/models/team.model';\r\nimport * as TeamsActions from 'src/app/store/actions/teams.actions';\r\nimport * as TeamsSelectors from 'src/app/store/selectors/teams.selectors';\r\nimport * as AuthSelectors from 'src/app/store/selectors/auth.selectors';\r\nimport * as DesignersActions from 'src/app/store/actions/designers.actions'; // Para carregar designers e mostrar nomes\r\nimport * as DesignersSelectors from 'src/app/store/selectors/designers.selectors'; // Para obter designers\r\n\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ConfirmPopupComponent } from 'src/app/shared/components/confirm-popup/confirm-popup.component';\r\nimport { Router } from '@angular/router';\r\nimport { filter, tap, map } from 'rxjs/operators';\r\nimport { Designer } from 'src/app/core/models/designer.model';\r\n\r\n@Component({\r\n    selector: 'app-teams-list-page',\r\n    templateUrl: './teams-list-page.component.html',\r\n    styleUrls: ['./teams-list-page.component.scss']\r\n})\r\nexport class TeamsListPageComponent implements OnInit {\r\n    teams$: Observable<Team[]>;\r\n    isLoading$: Observable<boolean>;\r\n    error$: Observable<any>;\r\n    displayedColumns: string[] = ['name', 'description', 'designers', 'actions'];\r\n    private userCompanyId: string | null = null;\r\n    allDesigners: Designer[] = []; // Para mapear IDs de projetistas para nomes\r\n\r\n    constructor(private store: Store, private dialog: MatDialog, private router: Router) {\r\n        this.teams$ = this.store.select(TeamsSelectors.selectAllTeams);\r\n        this.isLoading$ = this.store.select(TeamsSelectors.selectTeamsLoading);\r\n        this.error$ = this.store.select(TeamsSelectors.selectTeamsError);\r\n\r\n        this.store.select(DesignersSelectors.selectAllDesigners).subscribe(designers => {\r\n            this.allDesigners = designers;\r\n        });\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.store.select(AuthSelectors.selectUserCompanyId)\r\n            .pipe(\r\n                filter(companyId => !!companyId),\r\n                tap(companyId => {\r\n                    this.userCompanyId = companyId;\r\n                    this.store.dispatch(TeamsActions.loadTeams({ companyId: this.userCompanyId }));\r\n                    this.store.dispatch(DesignersActions.loadDesigners({ companyId: this.userCompanyId })); // Carrega designers para a lista\r\n                })\r\n            ).subscribe();\r\n    }\r\n\r\n    getDesignerNames(designerIds: string[]): string {\r\n        if (!designerIds || designerIds.length === 0) {\r\n            return 'Nenhum projetista';\r\n        }\r\n        return designerIds\r\n            .map(id => this.allDesigners.find(d => d.id === id)?.name)\r\n            .filter(name => !!name)\r\n            .join(', ');\r\n    }\r\n\r\n    onEditTeam(teamId: string): void {\r\n        this.router.navigate(['/company/teams/edit', teamId]);\r\n    }\r\n\r\n    onDeleteTeam(teamId: string): void {\r\n        const dialogRef = this.dialog.open(ConfirmPopupComponent, {\r\n            data: {\r\n                title: 'Confirmar Exclusão',\r\n                message: 'Tem certeza que deseja excluir esta equipe? Esta ação é irreversível.',\r\n            }\r\n        });\r\n\r\n        dialogRef.afterClosed().subscribe(result => {\r\n            if (result) {\r\n                this.store.dispatch(TeamsActions.deleteTeam({ id: teamId }));\r\n            }\r\n        });\r\n    }\r\n\r\n    onCreateTeam(): void {\r\n        this.router.navigate(['/company/teams/new']);\r\n    }\r\n}","<div class=\"container\">\r\n    <h2>Gerenciar Equipes</h2>\r\n\r\n    <div class=\"actions\">\r\n        <button mat-raised-button color=\"primary\" (click)=\"onCreateTeam()\">\r\n            <mat-icon>add</mat-icon> Adicionar Equipe\r\n        </button>\r\n    </div>\r\n\r\n    <mat-progress-bar *ngIf=\"isLoading$ | async\" mode=\"indeterminate\"></mat-progress-bar>\r\n\r\n    <div *ngIf=\"(teams$ | async) as teams\">\r\n        <div *ngIf=\"teams.length === 0 && !(isLoading$ | async)\">\r\n            <p>Nenhuma equipe encontrada para sua empresa.</p>\r\n        </div>\r\n\r\n        <table mat-table [dataSource]=\"teams\" class=\"mat-elevation-z8\" *ngIf=\"teams.length > 0\">\r\n\r\n            <ng-container matColumnDef=\"name\">\r\n                <th mat-header-cell *matHeaderCellDef> Nome </th>\r\n                <td mat-cell *matCellDef=\"let element\"> {{element.name}} </td>\r\n            </ng-container>\r\n\r\n            <ng-container matColumnDef=\"description\">\r\n                <th mat-header-cell *matHeaderCellDef> Descrição </th>\r\n                <td mat-cell *matCellDef=\"let element\"> {{element.description}} </td>\r\n            </ng-container>\r\n\r\n            <ng-container matColumnDef=\"designers\">\r\n                <th mat-header-cell *matHeaderCellDef> Projetistas </th>\r\n                <td mat-cell *matCellDef=\"let element\"> {{ getDesignerNames(element.designerIds) }} </td>\r\n            </ng-container>\r\n\r\n            <ng-container matColumnDef=\"actions\">\r\n                <th mat-header-cell *matHeaderCellDef> Ações </th>\r\n                <td mat-cell *matCellDef=\"let element\">\r\n                    <button mat-icon-button color=\"accent\" (click)=\"onEditTeam(element.id)\">\r\n                        <mat-icon>edit</mat-icon>\r\n                    </button>\r\n                    <button mat-icon-button color=\"warn\" (click)=\"onDeleteTeam(element.id)\">\r\n                        <mat-icon>delete</mat-icon>\r\n                    </button>\r\n                </td>\r\n            </ng-container>\r\n\r\n            <tr mat-header-row *matHeaderRowDef=\"displayedColumns\"></tr>\r\n            <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\"></tr>\r\n        </table>\r\n    </div>\r\n\r\n    <div *ngIf=\"error$ | async as error\" class=\"error-message\">\r\n        Erro: {{ error?.message }}\r\n    </div>\r\n</div>"]},"metadata":{},"sourceType":"module"}